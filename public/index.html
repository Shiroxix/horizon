<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Horizon Command | Ultra Vision</title>
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@600;700&family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root { 
            --primary: #00f2ff; --accent: #bc13fe; --bg: #020408; 
            --card: #0d121d; --text: #f8fafc; --success: #00ff88; --danger: #ff4655;
            --border: rgba(255, 255, 255, 0.1); --glass: rgba(15, 23, 42, 0.8);
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; }
        body { background: var(--bg); color: var(--text); overflow-x: hidden; min-height: 100vh; }

        .bg-glow {
            position: fixed; inset: 0; z-index: -1;
            background: 
                radial-gradient(circle at 20% 20%, rgba(188, 19, 254, 0.15), transparent 40%),
                radial-gradient(circle at 80% 80%, rgba(0, 242, 255, 0.15), transparent 40%);
        }

        /* TELAS DE AUTH */
        #authScreen {
            position: fixed; inset: 0; z-index: 9999; background: var(--bg);
            display: flex; align-items: center; justify-content: center; backdrop-filter: blur(20px);
        }
        .auth-card {
            background: var(--card); border: 1px solid var(--border); padding: 40px;
            border-radius: 30px; width: 100%; max-width: 420px; text-align: center;
            box-shadow: 0 25px 50px rgba(0,0,0,0.5); display: none;
        }
        .auth-card.active { display: block; animation: fadeIn 0.5s ease; }

        .input-cyber {
            width: 100%; background: rgba(0,0,0,0.3); border: 1px solid var(--border);
            padding: 15px; border-radius: 12px; color: #fff; margin-bottom: 15px;
            font-family: 'Rajdhani'; font-size: 1.1rem; transition: 0.3s;
        }
        .input-cyber:focus { border-color: var(--primary); box-shadow: 0 0 15px rgba(0,242,255,0.2); }

        .btn-main {
            width: 100%; padding: 15px; border-radius: 12px; border: none;
            background: linear-gradient(90deg, var(--accent), var(--primary));
            color: #000; font-weight: 900; cursor: pointer; text-transform: uppercase;
            letter-spacing: 2px; transition: 0.3s;
        }
        .btn-main:hover { transform: scale(1.02); filter: brightness(1.2); }

        /* DASHBOARD */
        #mainContent { display: none; padding: 20px; }
        header { 
            display: flex; justify-content: space-between; align-items: center; 
            padding: 20px 0 40px; border-bottom: 1px solid var(--border); margin-bottom: 40px;
        }
        .logo { font-family: 'Rajdhani'; font-size: 2rem; font-weight: 700; letter-spacing: 5px; color: #fff; }

        .user-nav { display: flex; align-items: center; gap: 15px; position: relative; }
        .user-name { font-weight: 900; font-size: 0.9rem; color: var(--primary); text-transform: uppercase; }
        .user-id { font-size: 0.7rem; color: #64748b; cursor: pointer; background: rgba(255,255,255,0.05); padding: 4px 8px; border-radius: 5px; }

        .popup-menu {
            position: absolute; top: 110%; right: 0; background: var(--card);
            border: 1px solid var(--border); border-radius: 15px; padding: 10px;
            width: 200px; display: none; z-index: 100;
        }
        .popup-menu.active { display: block; }
        .menu-item { padding: 12px; border-radius: 10px; cursor: pointer; font-size: 0.8rem; display: flex; align-items: center; gap: 10px; }
        .menu-item:hover { background: rgba(255,255,255,0.05); color: var(--primary); }

        .grid-stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }
        .card-impact { background: var(--card); border-radius: 24px; padding: 25px; border: 1px solid var(--border); }

        .log-table { width: 100%; border-collapse: collapse; font-size: 0.75rem; }
        .log-table td { padding: 12px 5px; border-bottom: 1px solid rgba(255,255,255,0.02); }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

    <div class="bg-glow"></div>

    <div id="authScreen">
        <div class="auth-card active" id="loginBox">
            <h1 class="logo" style="margin-bottom: 30px;">HORIZON</h1>
            <input type="text" id="userIn" class="input-cyber" placeholder="NOME DE USUÁRIO">
            <input type="password" id="passIn" class="input-cyber" placeholder="SENHA">
            <button class="btn-main" onclick="handleLogin()">Acessar Painel</button>
            <p style="margin-top: 20px; font-size: 0.8rem; color: #64748b;">
                Não tem conta? <a href="javascript:void(0)" onclick="switchAuth('register')" style="color:var(--primary)">Criar agora</a>
            </p>
        </div>

        <div class="auth-card" id="registerBox">
            <h1 class="logo" style="margin-bottom: 30px;">REGISTRO</h1>
            <input type="text" id="regUser" class="input-cyber" placeholder="ESCOLHA UM NOME">
            <input type="password" id="regPass" class="input-cyber" placeholder="CRIE UMA SENHA">
            <button class="btn-main" onclick="handleRegister()">Finalizar Cadastro</button>
            <p style="margin-top: 20px; font-size: 0.8rem; color: #64748b;">
                Já tem conta? <a href="javascript:void(0)" onclick="switchAuth('login')" style="color:var(--primary)">Voltar ao Login</a>
            </p>
        </div>
    </div>

    <div id="mainContent">
        <div class="container">
            <header>
                <h1 class="logo">HORIZON</h1>
                <div class="user-nav">
                    <div style="text-align: right;">
                        <div class="user-name" id="displayUsername">USUÁRIO</div>
                        <div class="user-id" onclick="copyID()">ID: <span id="displayID">------</span> <i class="far fa-copy"></i></div>
                    </div>
                    <i class="fas fa-ellipsis-v" style="cursor:pointer; padding:10px;" onclick="toggleMenu()"></i>
                    <div class="popup-menu" id="perfilMenu">
                        <div class="menu-item" onclick="logout()" style="color:var(--danger)"><i class="fas fa-sign-out-alt"></i> Sair</div>
                    </div>
                </div>
            </header>

            <div class="grid-stats">
                <div class="card-impact">
                    <h3 style="font-family:'Rajdhani'; margin-bottom: 15px; color: var(--primary);">ATIVIDADE RECENTE</h3>
                    <canvas id="mainChart"></canvas>
                </div>
                <div class="card-impact">
                    <h3 style="font-family:'Rajdhani'; margin-bottom: 15px; color: var(--accent);">LOGS DO SISTEMA</h3>
                    <div style="max-height: 300px; overflow-y: auto;">
                        <table class="log-table">
                            <tbody id="logTableBody"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const MASTER_ADMIN = "shiro";
        const MASTER_PASS = "18172220";

        // Alternar entre Login e Registro
        function switchAuth(mode) {
            document.getElementById('loginBox').classList.remove('active');
            document.getElementById('registerBox').classList.remove('active');
            if(mode === 'login') document.getElementById('loginBox').classList.add('active');
            else document.getElementById('registerBox').classList.add('active');
        }

        // Lógica de Registro
        function handleRegister() {
            const u = document.getElementById('regUser').value.trim();
            const p = document.getElementById('regPass').value.trim();

            if(!u || !p) return alert("Preencha todos os campos!");

            let accounts = JSON.parse(localStorage.getItem("hz_accounts")) || {};
            if(accounts[u]) return alert("Este nome já está em uso!");

            const newID = Math.random().toString(36).substring(2, 8).toUpperCase();
            accounts[u] = { username: u, password: p, id: newID, isAdm: false };
            
            localStorage.setItem("hz_accounts", JSON.stringify(accounts));
            registrarLog("Conta Criada", u);
            alert("Conta criada com sucesso! Faça login.");
            switchAuth('login');
        }

        // Lógica de Login
        function handleLogin() {
            const u = document.getElementById('userIn').value.trim();
            const p = document.getElementById('passIn').value.trim();

            if(u.toLowerCase() === MASTER_ADMIN && p === MASTER_PASS) {
                return loginSuccess({ username: "Shiro", id: "MASTER-01", isAdm: true });
            }

            let accounts = JSON.parse(localStorage.getItem("hz_accounts")) || {};
            if(accounts[u] && accounts[u].password === p) {
                loginSuccess(accounts[u]);
            } else {
                alert("Usuário ou senha incorretos!");
            }
        }

        function loginSuccess(userObj) {
            localStorage.setItem("hz_user", JSON.stringify(userObj));
            registrarLog("Login", userObj.username);
            location.reload(); // Recarrega para aplicar a persistência
        }

        // Logs e Persistência
        function registrarLog(acao, usuario) {
            let logs = JSON.parse(localStorage.getItem("hz_logs")) || [];
            logs.unshift({ usuario, acao, tempo: new Date().toLocaleTimeString() });
            localStorage.setItem("hz_logs", JSON.stringify(logs.slice(0, 20)));
        }

        function renderLogs() {
            const logs = JSON.parse(localStorage.getItem("hz_logs")) || [];
            document.getElementById('logTableBody').innerHTML = logs.map(l => `
                <tr>
                    <td><b>${l.usuario}</b></td>
                    <td>${l.acao}</td>
                    <td style="color:#64748b">${l.tempo}</td>
                </tr>
            `).join('');
        }

        function logout() {
            const user = JSON.parse(localStorage.getItem("hz_user"));
            if(user) registrarLog("Logout", user.username);
            localStorage.removeItem("hz_user");
            location.reload();
        }

        function copyID() {
            const id = document.getElementById('displayID').innerText;
            navigator.clipboard.writeText(id);
            alert("ID Copiado!");
        }

        function toggleMenu() { document.getElementById('perfilMenu').classList.toggle('active'); }

        // Inicialização
        window.onload = () => {
            const user = JSON.parse(localStorage.getItem("hz_user"));
            if(user) {
                document.getElementById('authScreen').style.display = 'none';
                document.getElementById('mainContent').style.display = 'block';
                document.getElementById('displayUsername').innerText = user.username;
                document.getElementById('displayID').innerText = user.id;
                initChart();
            }
            renderLogs();
        };

        function initChart() {
            const ctx = document.getElementById('mainChart').getContext('2d');
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['Seg', 'Ter', 'Qua', 'Qui', 'Sex'],
                    datasets: [{
                        label: 'Atividade',
                        data: [12, 19, 15, 25, 22],
                        borderColor: '#00f2ff',
                        tension: 0.4,
                        fill: true,
                        backgroundColor: 'rgba(0, 242, 255, 0.1)'
                    }]
                },
                options: { plugins: { legend: { display: false } } }
            });
        }
    </script>
</body>
</html>
